<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pyodide Code Executor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        textarea {
            width: 100%;
            height: 200px;
            font-family: monospace;
            font-size: 16px;
            padding: 10px;
        }

        button {
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }

        #output {
            margin-top: 20px;
            white-space: pre-wrap;
            background-color: #f4f4f4;
            padding: 10px;
            border: 1px solid #ddd;
        }

        /* Spinner styles */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #ccc;
            border-top: 3px solid #333;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
            visibility: hidden; /* Hidden by default */
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>

<h2>Python Code Executor using Pyodide</h2>

<!-- Text area for user input -->
<textarea id="pythonCode" placeholder="Enter Python code here..."></textarea>

<!-- Button to execute Python code -->
<button onclick="runPython()">Run Python Code</button>
<span class="spinner" id="spinner"></span>

<!-- Area to display the output of Python code -->
<div id="output"></div>

<script src="https://cdn.jsdelivr.net/pyodide/v0.22.1/full/pyodide.js"></script>

<script type="text/javascript">
    async function runPython() {
        // Show the spinner
        document.getElementById("spinner").style.visibility = "visible";

        // Load Pyodide
        let pyodide = await loadPyodide();

        // Get the code from the textarea
        let pythonCode = document.getElementById("pythonCode").value;

        // Try to run the user-provided Python code and capture any errors
        try {
            // Redirect standard output to capture print() statements
            pyodide.runPython(`
import sys
from io import StringIO
sys.stdout = StringIO()
            `);

            // Run the Python code
            pyodide.runPython(pythonCode);

            // Get the captured output
            let output = pyodide.runPython("sys.stdout.getvalue()");

            // Display the result
            document.getElementById("output").innerText = "Output:\n" + output;
        } catch (error) {
            // Display any errors from the Python code
            document.getElementById("output").innerText = "Error:\n" + error;
        } finally {
            // Hide the spinner
            document.getElementById("spinner").style.visibility = "hidden";
        }
    }
</script>

</body>
</html>
